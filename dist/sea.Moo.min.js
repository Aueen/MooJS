/**
 * MooLib
 *
 * 会哞哞叫的Javascript工具类
 * A Javascript library with a moo moo here and there.
 *
 * - 这是Seajs插件版本的MooJS
 * - This is the version of MooJS running with seajs.
 *
 * @author Jakit
 * @copyright Jakit
 * @date 2016/3/31
 */
define(function(require,exports){var Moo=function(){this.site_url=function(){return window.location.protocol+"//"+window.location.host};this.listing=function(){this.select=function(select,data,attr){select.html("");var row;for(i in data){row='<option value="'+data[i][attr.value]+'">'+data[i][attr.text]+"</option>";select.append(row)}};this.table=function(tbody,data,fields){tbody.html("");var row;for(i in data){row="<tr>";for(j in fields){row+="<td>"+data[i][fields[j]]+"</td>"}row+="</tr>";tbody.append(row)}}};this.paging=function(pagination,total,pages,callback){if(typeof pages==="undefined"){pages=10}else if(typeof pages==="function"){callback=pages;pages=10}var page_groups=Math.ceil(total/pages);var current_group=1;var change_status=function(){pagination.html("");var last=current_group*pages;var first=last-pages+1;if(last>total){last=total}for(var i=first;i<=last;i++){pagination.append('<li><a href="javascript:;" aria-label="Page" page-data="'+i+'">'+i+"</a></li>")}if(typeof callback==="function"){pagination.find("a[aria-label='Page']").each(function(index){$(this).click(function(){callback($(this).attr("page-data"))})})}pagination.prepend('<li><a href="javascript:;" aria-label="Previous">&laquo;</a></li>');pagination.append('<li><a href="javascript:;" aria-label="Next">&raquo;</a></li>');if(current_group>1){pagination.find("a[aria-label='Previous']").click(function(){current_group--;change_status()})}else{pagination.find("a[aria-label='Previous']").parent().addClass("disabled")}if(current_group<page_groups){pagination.find("a[aria-label='Next']").click(function(){current_group++;change_status()})}else{pagination.find("a[aria-label='Next']").parent().addClass("disabled")}};change_status()};this.template=function(data,replacement){var reg=RegExp(/\[\w+\]/g);var reg_word=RegExp(/\w+/);return data.replace(reg,function(word){return replacement[word.match(reg_word)]})};this.curl=function(){this.submit=function(url,form_data,callback){$.post(url,form_data,callback)};this.fetch=function(url,callback){$.get(url,callback)};this.take=function(url,param,callback){$.get(url,param,callback)};this.upload=function(file,url,type,name,callback){var fd=new FormData;fd.append(name,file);var xhr=new XMLHttpRequest;xhr.open("POST",url,true);xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){callback(xhr.responseText)}else if(xhr.readyState==4&&xhr.status!=200){console.log({state:xhr.readyState,status:xhr.status,text:xhr.responseText})}};xhr.send(fd)}};this.lazy=function(callback,time,times,t){times=typeof times==="undefined"?1:times;if(!t){t=this}else{var result=callback();if(result||!times){return}times--}var lz=t.lazy;if(times>0){setTimeout(function(){lz(callback,time,times,t)},time)}}};exports.Moo=new Moo});